(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3214],{89921:function(e,t,r){"use strict";r.d(t,{f:function(){return ae},Z:function(){return le}});var n=r(94776),a=r.n(n),l=r(52322),i=r(2784),o=r(65805),s=r(3559),c=r(72342),p=r(49174),u=r.n(p);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var f=function(e){var t=e.onClose,r=m(e,["onClose"]);return(0,l.jsx)(c.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){d(e,t,r[t])}))}return e}({title:"Unable to apply template",className:u().errorWrapper,onClose:t},r,{children:(0,l.jsxs)("div",{className:u().errorBody,children:[(0,l.jsx)("p",{className:u().subtitle,children:"Please remove all content from the file to apply the template."}),(0,l.jsx)(s.ZP,{size:s.ZP.Sizes.LARGE,className:u().errorButton,onClick:t,children:"Return to File"})]})}))},v=r(39739),h=r(20810),b=r(96577),y=r.n(b),j=r(24507),x=r(76117),g=r(28058),_=(0,i.forwardRef)((function(e,t){var r=e.id,n=e.name,a=e.thumbnailURL,o=e.selected,s=e.onClick,c=(0,i.useCallback)((function(){return s(r)}),[r,s]),p=(0,j.F)().isDarkMode;return(0,l.jsxs)("div",{ref:t,onClick:c,className:(0,g.Z)(u().template,p&&u().isDarkMode,o&&u().templateActive),children:[(0,l.jsx)("div",{className:(0,g.Z)(u().thumbnail,o&&u().thumbnailActive),children:(0,l.jsx)("div",{className:u().imageWrapper,children:(0,l.jsx)(y(),{unoptimized:!0,layout:"fill",loading:"lazy",objectFit:"contain",src:(0,x.V)("templates/".concat(a),{auto:["compress","format"]})})})}),(0,l.jsx)("strong",{className:u().templateTitle,children:n})]})}));_.displayName="TemplateItem";var C=r(7031),T=r(99627),k=r(51992),w=function(){return(0,l.jsxs)("div",{className:u().template,children:[(0,l.jsx)("div",{className:u().thumbnail,children:(0,l.jsx)(k.ZP,{count:1,width:188,height:230})}),(0,l.jsx)("h3",{className:u().templateTitle,children:(0,l.jsx)(k.ZP,{count:1,width:140,height:14})})]})},Z=function(){return(0,l.jsx)("div",{className:u().categoryTab,children:(0,l.jsx)(k.ZP,{count:1,width:130,height:14,style:{marginLeft:-5}})})},O=function(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w,{}),(0,l.jsx)(w,{}),(0,l.jsx)(w,{}),(0,l.jsx)(w,{}),(0,l.jsx)(w,{}),(0,l.jsx)(w,{})]})},P=function(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z,{}),(0,l.jsx)(Z,{}),(0,l.jsx)(Z,{}),(0,l.jsx)(Z,{}),(0,l.jsx)(Z,{})]})},N="all",A=function(e){var t=e.categories,r=e.selectedCategoryId,n=e.onCategoryChange,a=e.templates,o=e.selectedTemplateId,c=e.selectedTemplateRef,p=e.onTemplateSelect,d=e.onPreviewClick,m=e.onApplyClick,f=e.disabled,v=(0,i.useCallback)((function(){return o&&d(o)}),[o,d]),h=(0,i.useCallback)((function(){return o&&m(o)}),[o,m]);return(0,l.jsxs)("div",{className:u().content,children:[(0,l.jsx)("p",{className:u().subtitle,children:"Browse our various templates to quickly get a headstart on your file"}),(0,l.jsxs)("div",{className:u().body,children:[(0,l.jsxs)("div",{className:u().left,children:[(0,l.jsx)(T.Z,{label:"All",id:N,className:u().categoryOption,onClick:function(){return n(N)},isSelected:r===N},N),Array.isArray(t)?t.map((function(e){return(0,l.jsx)(T.Z,{id:e.id,label:e.name,className:u().categoryOption,onClick:function(){return n(e.id)},isSelected:e.id===r},e.id)})):(0,l.jsx)(P,{})]}),(0,l.jsx)("div",{className:u().right,children:Array.isArray(a)?a.map((function(e){return(0,l.jsx)(_,{id:e.id,name:e.name,onClick:p,thumbnailURL:e.thumbnailUrl,selected:e.id===o,ref:e.id===o?c:void 0},e.id)})):(0,l.jsx)(O,{})})]}),(0,l.jsx)("div",{className:u().separator}),(0,l.jsx)(C.Z,{className:u().footer,children:(0,l.jsxs)("div",{className:u().buttons,children:[(0,l.jsx)(s.ZP,{disabled:f||!o,variant:s.ZP.Variants.REVERSED,onClick:v,children:"View Preview"}),(0,l.jsx)(s.ZP,{size:s.ZP.Sizes.LARGE,disabled:f||!o,onClick:h,children:"Add Template to File"})]})})]})},S=r(9605),E=r(41573),R=r(52251),B=r(7867),I=r(97442),M=I.Z,F=r(3213),V=r(90396),z=function(){return(0,B.BS)(F.Z.templateCategories.withConverter(M).orderBy("order","asc")).pipe((0,V.pA)([]),(0,V.VK)(),(0,V.Fb)([]))},D=I.Z,L=function(){return(0,B.BS)(F.Z.templates.withConverter(D).where("isVisible","==",!0).orderBy("order","asc")).pipe((0,V.pA)([]),(0,V.VK)(),(0,V.Fb)([]))},U=r(17366),W=r(66924),G=function(e){var t=e.templateId,r=e.imageURL,n=e.onBackClick,a=e.onApplyClick,o=e.disabled,c=(0,i.useCallback)((function(){return t&&a(t)}),[t,a]);return(0,l.jsxs)("div",{className:u().content,children:[(0,l.jsx)("div",{className:u().previewBorder,children:(0,l.jsx)("div",{className:u().imageWrapper,children:(0,l.jsx)(y(),{src:(0,x.V)("templates/".concat(r),{auto:["compress","format"]}),layout:"fill",objectFit:"contain",loading:"lazy",unoptimized:!0})})}),(0,l.jsx)(C.Z,{className:u().footer,children:(0,l.jsxs)("div",{className:u().buttons,children:[(0,l.jsx)(s.ZP,{variant:s.ZP.Variants.REVERSED,disabled:o,onClick:n,children:"Back to Templates"}),(0,l.jsx)(s.ZP,{size:s.ZP.Sizes.LARGE,disabled:o,onClick:c,children:"Add Template to File"})]})})]})};function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(){return q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q.apply(this,arguments)}var K=function(e){var t,r=q({},e),n=(0,E.mT)(),a=(0,S.Z)(),s=(0,i.useState)("templates"),p=s[0],d=s[1],m=(0,i.useState)(),f=m[0],b=m[1],y=(0,i.useState)(),j=y[0],x=y[1],g=(0,i.useState)(N),_=g[0],C=g[1],T=(0,i.useState)(),k=T[0],w=T[1],Z=(0,i.useRef)(null),O=function(e){var t=e.categories,r=e.templates,n=(0,i.useMemo)((function(){return null===r||void 0===r?void 0:r.reduce((function(e,t){return e[t.id]=t,e}),{})}),[r]),a=(0,i.useMemo)((function(){return null===t||void 0===t?void 0:t.reduce((function(e,t){return e[t.id]=t,e}),{})}),[t]),l=(0,i.useMemo)((function(){return a&&r?null===r||void 0===r?void 0:r.reduce((function(e,t){return t.categories.forEach((function(r){e[r]||(e[r]=[]),(null===a||void 0===a?void 0:a[r])||console.warn("Invalid template category id:",r),e[r].push(t)})),e}),{}):void 0}),[a,r]);return{categoriesMap:a,templatesMap:n,templatesByCategoryMap:l}}({templates:f,categories:j}),P=O.templatesMap,B=O.templatesByCategoryMap,I=(0,o.Z)(),M=I.onTemplateErrorShow,F=I.canUseTemplate,V=I.applyTemplateAsync,D=I.isTemplateApplyInProgress;(0,v.m)((0,h.m)(L),b,W.Tb),(0,v.m)((0,h.m)(z),x,W.Tb),(0,U.Z)((function(){var e;"templates"===p&&(null===(e=Z.current)||void 0===e||e.scrollIntoView({behavior:"auto",block:"center",inline:"center"}))}),[p]);var K=_===N?f:null!==(t=null===B||void 0===B?void 0:B[_])&&void 0!==t?t:[],Y=(0,i.useCallback)((function(e){D||(C(e),w(void 0))}),[D]),H=(0,i.useCallback)((function(e){D||w(e)}),[D]),Q=(0,i.useCallback)((function(){D||(k&&R.Z.trackEvent("template","preview",{templateName:P[k].name}),d("preview"))}),[D,k,P]),X=(0,i.useCallback)((function(){D||d("templates")}),[D]),$=(0,i.useCallback)((function(e){if(n){var t;if(!F)return null===(t=r.onClose)||void 0===t||t.call(r),void M();k&&R.Z.trackEvent("template","use",{templateName:P[k].name}),a.promise(V.execute({workspaceId:n,templateId:e}),{loading:"Applying template",success:"Applied template",error:"Something went wrong"},{success:{duration:1e3}}).then((function(){var e;return null===(e=r.onClose)||void 0===e?void 0:e.call(r)}),W.Tb)}}),[n,F,a,V,k,P,r,M]);return(0,l.jsx)(c.Z,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){J(e,t,r[t])}))}return e}({},r,{title:k?P[k].name:"Start from a Template",className:u().wrapper,"data-testid":"templates-modal",children:"preview"===p&&k?(0,l.jsx)(G,{templateId:k,imageURL:P[k].previewUrl,onBackClick:X,onApplyClick:$,disabled:V.loading}):(0,l.jsx)(A,{categories:j,selectedCategoryId:_,onCategoryChange:Y,templates:K,selectedTemplateId:k,selectedTemplateRef:Z,onTemplateSelect:H,onPreviewClick:Q,onApplyClick:$,disabled:V.loading})}))},Y=function(){var e=(0,o.Z)(),t=e.isTemplateModalOpen,r=e.onTemplateModalClose,n=e.isTemplateErrorOpen,a=e.onTemplateErrorClose;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(K,{isOpen:t,onClose:r}),(0,l.jsx)(f,{isOpen:n,onClose:a})]})},H=r(17003),Q=r(32712),X=r(48215),$=function(e){return(0,X.Z)("template-apply",e)},ee=r(77432),te=r(83445);function re(e,t,r,n,a,l,i){try{var o=e[l](i),s=o.value}catch(c){return void r(c)}o.done?t(s):Promise.resolve(s).then(n,a)}var ne=(0,i.createContext)(void 0),ae=function(e){var t,r=e.children,n=(0,Q.Z)(),o=n.isWhiteboardReady,s=n.isNotepadReady,c=n.isWhiteboardEmpty,p=n.isNotepadEmpty,u=(0,te.Z)(),d=u.isOpen,m=u.onOpen,f=u.onClose,v=(0,te.Z)(),h=v.isOpen,b=v.onOpen,y=v.onClose,j=o&&s&&c&&p,x=(0,i.useCallback)(function(){var e,t=(e=a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$(t).then((function(){return(0,ee.Z)(t.workspaceId)})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,a){var l=e.apply(t,r);function i(e){re(l,n,a,i,o,"next",e)}function o(e){re(l,n,a,i,o,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),[]),g=(0,H.Z)(x),_={canUseTemplate:j,isTemplateModalOpen:d,onStartFromTemplate:j?m:void 0,onTemplateModalClose:f,isTemplateErrorOpen:h,onTemplateErrorClose:y,onTemplateErrorShow:b,applyTemplateAsync:g,isTemplateApplyInProgress:(0,E.gL)()||g.loading,templateAppliedAt:null===(t=(0,E.Po)())||void 0===t?void 0:t.toMillis()};return(0,l.jsxs)(ne.Provider,{value:_,children:[r,(0,l.jsx)(Y,{})]})},le=ne},32712:function(e,t,r){"use strict";var n=r(2784),a=r(97184);t.Z=function(){return(0,n.useContext)(a.ZP)}},65805:function(e,t,r){"use strict";var n=r(2784),a=r(89921);t.Z=function(){return(0,n.useContext)(a.Z)}},49174:function(e){e.exports={wrapper:"Templates_wrapper__PFSPr",subtitle:"Templates_subtitle__5YX7G",content:"Templates_content__ReJ31",body:"Templates_body__GkV0j",left:"Templates_left__8neOs",right:"Templates_right__Y_eso",categoryOption:"Templates_categoryOption__PAWx9",template:"Templates_template__gJSId",templateActive:"Templates_templateActive__SczU5",isDarkMode:"Templates_isDarkMode__kPebE",thumbnailActive:"Templates_thumbnailActive__V10sq",thumbnail:"Templates_thumbnail__RQ2CL",imageWrapper:"Templates_imageWrapper__EknIv",previewBorder:"Templates_previewBorder__Ti9No",templateTitle:"Templates_templateTitle__yist4",separator:"Templates_separator___c1NC",footer:"Templates_footer__wDAoH",errorBody:"Templates_errorBody__Zyk51",errorWrapper:"Templates_errorWrapper__CJnav",errorButton:"Templates_errorButton__Dlrut"}}}]);